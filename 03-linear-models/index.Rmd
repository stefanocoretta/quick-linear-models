---
title: "Linear models: The basics"
author: "Stefano Coretta"
institute: "University of Edinburgh"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css:
      - default
      - ../ipa-fonts.css
      - ../custom.css
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      beforeInit: "../macros.js"
      ratio: 16:9
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, dpi = 300, out.height = "500px", fig.align = "center")
knitr::opts_knit$set(root.dir = here::here())
options(htmltools.dir.version = FALSE)
library(tidyverse)
theme_set(theme_minimal(base_size = 16))
library(xaringanExtra)
use_xaringan_extra(c("panelset", "tachyons"))
```

class: center middle inverse

# Time travel...

---

# Given the .green[formula], find the .orange[points]


## You have:

.f2[$$x = (2, 4, 5, 8, 10, 23, 36)$$]

.f2[$$y = 3 + 2x$$]

## Find:

.f2[$$y$$]


---

# Given the .green[formula], find the .orange[points]

```{r homework}
x <- c(2, 4, 5, 8, 10, 23, 36)
line <- tibble(
  x = x,
  y = 3 + 2 * x
)
ggplot(line, aes(x, y)) +
  geom_point(size = 5) +
  labs(title = bquote(italic(y) == 3 + 2 * italic(x)))
```

---

# Given the .green[formula], find the .orange[points]

```{r line}
ggplot(line, aes(x, y)) +
  geom_point(size = 5, colour = "gray") +
  geom_line(colour = "red") +
  labs(title = bquote(italic(y) == 3 + 2 * italic(x)))
```

---

# Given the .orange[points], find the .green[formula]

## You have:

.f2[$$x = (2, 4, 5, 8, 10, 23, 36)$$]

.f2[$$y = (7, 11, 13, 19, 23, 49, 75)$$]

## Find:

.f2[$$y = ? + ? x$$]

---

# Given the .orange[points], find the .green[formula]

```{r sample}
ggplot(line, aes(x, y)) +
  geom_point(size = 5) +
  labs(title = bquote(italic(y) == "?" + "?" * italic(x)))
```

---

# But...

.pull-left[
![](../img/world-data.jpg)
]

.pull-right[
.f2[Data is an .red[imperfect] representation of the world!]

Measurements are .red[noisy].
]

---

# Given the .orange[points], find the .green[formula]

```{r sample-noisy}
set.seed(4321)
line$y <- (2 + 3 * x) + rnorm(7, 0, 10)
ggplot(line, aes(x, y)) +
  geom_point(size = 5) +
  labs(title = bquote(italic(y) == "?" + "?" * italic(x)))
```

---

# Now enter Linear Models

<div style="width:100%;height:0;padding-bottom:42%;position:relative;"><iframe src="https://giphy.com/embed/3owzVYjZSzuFivWpHi" width="100%" height="100%" style="position:absolute" frameBorder="0" class="giphy-embed" allowFullScreen></iframe></div>

???

[via GIPHY](https://giphy.com/gifs/starwars-movie-star-wars-3owzVYjZSzuFivWpHi)

---

# Linear model

```{r lm-plot}
ggplot(line, aes(x, y)) +
  geom_point(size = 5, ) +
  geom_abline(intercept = 10, slope = 1, size = 2, colour = "blue", alpha = 0.2) +
  geom_abline(intercept = 30, slope = 2, size = 2, colour = "blue", alpha = 0.2) +
  geom_abline(intercept = -20, slope = 4, size = 2, colour = "blue", alpha = 0.2) +
  geom_abline(intercept = 15, slope = 6, size = 2, colour = "blue", alpha = 0.2) +
  geom_abline(intercept = 2, slope = 3, size = 2, colour = "blue", alpha = 0.2) +
  labs(title = bquote({italic(y) == "?" + "?" * italic(x)}))
```

---

# Linear model

```{r lm-plot-2}
ggplot(line, aes(x, y)) +
  geom_point(size = 5, ) +
  geom_abline(intercept = 10, slope = 1, size = 2, colour = "blue", alpha = 0.2) +
  geom_abline(intercept = 30, slope = 2, size = 2, colour = "blue", alpha = 0.2) +
  geom_abline(intercept = -20, slope = 4, size = 2, colour = "blue", alpha = 0.2) +
  geom_abline(intercept = 15, slope = 6, size = 2, colour = "blue", alpha = 0.2) +
  geom_abline(intercept = 2, slope = 3, size = 2, colour = "blue") +
  labs(title = bquote({italic(y) == "?" + "?" * italic(x)}))
```

---

# Linear model


.f1[
$$y = ? + ? x$$
]

---

# Linear model


.f1[
$$y = \beta_0 + \beta_1x$$
]

<br>

--

.f2[
$$\beta_0 = intercept$$
$$\beta_1 = slope$$
]

--

<br>

We know $x$ and $y$ and we need to .green[estimate] $\beta_0$ and $\beta_1$.

---


* We can add more predictors
    * $y = \beta_0 + \beta_1x_1 + \beta_2x_2 + ... + \beta_nx_n$

* `lm(y ~ x, data)` ('$y$ as a function of $x$')


